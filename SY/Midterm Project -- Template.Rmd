---
title: "Applied Data Science:  Midterm Project"
author: ""
date: ""
output:
  prettydoc::html_pretty:
  theme: cayman
highlight: github
---

```{r setup, include=FALSE}
set.seed(72)
knitr::opts_chunk$set(echo = TRUE, comment="", warning = FALSE, message = FALSE, tidy.opts=list(width.cutoff=55))
```

```{r libraries, echo = FALSE}
library(data.table)
library(DT)
library(rpart)
library(plyr)
library(FNN)
```

```{r source_files}
```

```{r constants}
n.values <- c(500, 1000, 2000)
iterations <- 3
# Data is 28 pixels big in width and height
img_rows <- img_cols <- 7
```


```{r load_data}
train.data <- read.csv("../Data/MNIST-fashion training set-49.csv")
test.data <- read.csv("../Data/MNIST-fashion testing set-49.csv")
```

```{r clean_data}
#' Data is transformed to matrix (because they are easier indexable) and  pixels
#' are separated from labels.
x_train <- as.matrix(train.data[, 2:dim(train.data)[2]])
y_train <- as.matrix(train.data[, 1])

# The same for test set.
x_test <- as.matrix(test.data[, 2:dim(train.data)[2]])
y_test <- as.matrix(test.data[, 1])

test.data <- list(x = x_test, y = y_test)

clothes.labels <-c( "T-shirt/top", "Trouser", "Pullover", "Dress", "Coat", "Sandal", "Shirt", "Sneaker", "Bag", "Ankle boot")
```

```{r functions}
sample_data <- function(sample_size){
  dat <- c()
  for(i in c(1:10)){
    dat <- c(dat,sample(c(1:6000 + 6000 * (i - 1)), size = sample_size/10))
  }
  return(list("x" = x_train[dat, ], "y" = y_train[dat, ]))
}
```

```{r generate_samples}
train_data_sample <- list(
  dat_500_1 = sample_data(500),
  dat_500_2 = sample_data(500),
  dat_500_3 = sample_data(500),
  dat_1000_1 = sample_data(1000),
  dat_1000_2 = sample_data(1000),
  dat_1000_3 = sample_data(1000),
  dat_2000_1 = sample_data(2000),
  dat_2000_2 = sample_data(2000),
  dat_2000_3 = sample_data(2000)
)
```

```{r playground}

```

## Introduction


### Model 1:  


```{r code_model1_development, eval = TRUE}
library(FNN)

model_kNN <- function(train_data, test_data = test.data){
  t1 <- Sys.time()
  test_pred_knn <- knn(train = train_data$x,
                       test = test_data$x,
                       cl = train_data$y,
                       k = 5)
  t2 <- Sys.time()
  A <- round(length(train_data$y) / 60000, 4)
  B <- round(min(1, as.numeric(t2 - t1) / 60), 4)
  C <- round(mean(test_pred_knn != test_data$y), 4)
  
  return(list(A = A, B = B, C = C))
}
```

```{r load_model1}
laply(train_data_sample, model_kNN)
```

### Model 2:  


```{r code_model2_development, eval = TRUE}

```

```{r load_model2}

```

### Model 3:  


```{r code_model3_development, eval = TRUE}

```

```{r load_model3}

```

### Model 4


```{r code_model4_development, eval = TRUE}

```

```{r load_model4}

```

### Model 5


```{r code_model5_development, eval = TRUE}

```

```{r load_model5}

```

### Model 6


```{r code_model6_development, eval = TRUE}

```

```{r load_model6}

```

### Model 7


```{r code_model7_development, eval = TRUE}

```

```{r load_model7}

```

### Model 8


```{r code_model8_development, eval = TRUE}

```

```{r load_model8}

```

### Model 9


```{r code_model9_development, eval = TRUE}

```

```{r load_model9}

```

### Model 10


```{r code_model10_development, eval = TRUE}

```

```{r load_model10}

```

## Scoreboard

```{r scoreboard}

```

## Discussion


## References


